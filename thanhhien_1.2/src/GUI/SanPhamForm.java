/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package GUI;

import BLL.CopyFileExample;
import BLL.ExcelIO;
import BLL.HoTro;
import BLL.ValidateForm;
import BLL.sanPhamCtrl;
import DAO.daoUserLogin;
import DTO.donViTinh;
import DTO.dtoSanPham;
import DTO.dtoThuocTinhSanPham;
import com.toedter.calendar.JDateChooser;
import java.awt.CardLayout;
import java.awt.Frame;
import java.awt.MouseInfo;
import java.awt.Point;
import java.awt.PointerInfo;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;
import java.io.File;
import java.io.FileWriter;
import java.io.IOException;

import java.util.ArrayList;
import java.util.Date;
import java.util.List;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.JFileChooser;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JOptionPane;
import javax.swing.plaf.basic.BasicInternalFrameUI;

/**
 *
 * @author bumte
 */
public class SanPhamForm extends javax.swing.JInternalFrame {

    public static List<String> khoangCach;
    public static List<String> trongLuong;
    public static List<String> loai;
    public static List<String> listNccSystem;
    public static List<String> listDanhMucSystem;
    public static List<String> listAllDVT;
    public static List<String> listDVTLe;
    public static List<dtoSanPham> listExcel;
    private dtoSanPham sp;
    private jdlSuaSoLuong editSL;
    public static dtoSanPham spUpdateSL;

    /**
     * Creates new form testSP
     */
    public SanPhamForm() {
        khoangCach = DAO.getList.listKhoangCach();
        trongLuong = DAO.getList.listTrongLuong();
        loai = DAO.getList.listLoai();
        listNccSystem = DAO.getList.listNCC();
        listDanhMucSystem = DAO.getList.listDanhMucSP();
        listAllDVT = new ArrayList<>();
        listAllDVT.addAll(khoangCach);
        listAllDVT.addAll(trongLuong);
        initComponents();
        this.setBorder(javax.swing.BorderFactory.createEmptyBorder(0, 0, 0, 0));
        BasicInternalFrameUI bi = (BasicInternalFrameUI) this.getUI();
        bi.setNorthPane(null);
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        chon = new javax.swing.JFileChooser();
        tbpMainPanel = new javax.swing.JTabbedPane();
        pnl1 = new javax.swing.JPanel();
        clpBangSP1 = new javax.swing.JScrollPane();
        tblSanPhamChiTiet = new javax.swing.JTable();
        txtTimKiem = new javax.swing.JTextField();
        btnLoadLaiBang = new javax.swing.JButton();
        pnlDangNhapDangXuat = new javax.swing.JPanel();
        pnlDangNhap = new javax.swing.JPanel();
        txtPass = new javax.swing.JPasswordField();
        jLabel15 = new javax.swing.JLabel();
        pnlDangXuat = new javax.swing.JPanel();
        jButton1 = new javax.swing.JButton();
        jLabel14 = new javax.swing.JLabel();
        jSeparator3 = new javax.swing.JSeparator();
        jPanel2 = new javax.swing.JPanel();
        jScrollPane2 = new javax.swing.JScrollPane();
        tblSanPhamSua = new javax.swing.JTable();
        jPanel6 = new javax.swing.JPanel();
        jPanel3 = new javax.swing.JPanel();
        jPanel4 = new javax.swing.JPanel();
        jLabel8 = new javax.swing.JLabel();
        jLabel9 = new javax.swing.JLabel();
        jLabel6 = new javax.swing.JLabel();
        jLabel11 = new javax.swing.JLabel();
        jLabel1 = new javax.swing.JLabel();
        jButton3 = new javax.swing.JButton();
        cbbGiaLe = new javax.swing.JComboBox();
        cbbDvt = new javax.swing.JComboBox();
        txtKhac = new javax.swing.JTextField();
        cbbTrongLuong = new javax.swing.JComboBox();
        jLabel5 = new javax.swing.JLabel();
        cbbDay = new javax.swing.JComboBox();
        jLabel2 = new javax.swing.JLabel();
        txtGiaLe = new javax.swing.JFormattedTextField();
        jLabel10 = new javax.swing.JLabel();
        cbbDanhMucSP = new javax.swing.JComboBox();
        jLabel7 = new javax.swing.JLabel();
        txtTenSP = new javax.swing.JTextField();
        jLabel3 = new javax.swing.JLabel();
        txtQuyCach = new javax.swing.JTextField();
        jLabel4 = new javax.swing.JLabel();
        txtGia = new javax.swing.JFormattedTextField();
        txtTrongLuong = new javax.swing.JFormattedTextField();
        cbbNhaCungCap = new javax.swing.JComboBox();
        cbbDai = new javax.swing.JComboBox();
        jButton2 = new javax.swing.JButton();
        jLabel12 = new javax.swing.JLabel();
        txtDay = new javax.swing.JFormattedTextField();
        txtDai = new javax.swing.JFormattedTextField();
        jSeparator1 = new javax.swing.JSeparator();
        jSeparator2 = new javax.swing.JSeparator();
        jButton5 = new javax.swing.JButton();
        jPanel5 = new javax.swing.JPanel();
        jLabel13 = new javax.swing.JLabel();
        jButton4 = new javax.swing.JButton();
        jPanel1 = new javax.swing.JPanel();
        btnThem1 = new javax.swing.JButton();
        btnThemExcel = new javax.swing.JButton();
        btnThem = new javax.swing.JButton();
        btnSua = new javax.swing.JButton();
        btnXoa = new javax.swing.JButton();
        jScrollPane1 = new javax.swing.JScrollPane();
        jTextArea1 = new javax.swing.JTextArea();
        jPanel13 = new javax.swing.JPanel();
        jTabbedPane1 = new javax.swing.JTabbedPane();
        jPanel7 = new javax.swing.JPanel();
        jPanel9 = new javax.swing.JPanel();
        clpBangSP2 = new javax.swing.JScrollPane();
        tblSPExecel = new javax.swing.JTable();
        jPanel8 = new javax.swing.JPanel();
        jButton6 = new javax.swing.JButton();
        jPanel11 = new javax.swing.JPanel();
        jScrollPane3 = new javax.swing.JScrollPane();
        jTextArea2 = new javax.swing.JTextArea();
        jPanel12 = new javax.swing.JPanel();
        jLabel16 = new javax.swing.JLabel();
        lblSS = new javax.swing.JLabel();
        jLabel18 = new javax.swing.JLabel();
        jLabel19 = new javax.swing.JLabel();
        lblDung = new javax.swing.JLabel();
        jLabel20 = new javax.swing.JLabel();
        jPanel10 = new javax.swing.JPanel();
        clpBangSP3 = new javax.swing.JScrollPane();
        tblSPExecelLoi = new javax.swing.JTable();

        addInternalFrameListener(new javax.swing.event.InternalFrameListener() {
            public void internalFrameActivated(javax.swing.event.InternalFrameEvent evt) {
                formInternalFrameActivated(evt);
            }
            public void internalFrameClosed(javax.swing.event.InternalFrameEvent evt) {
            }
            public void internalFrameClosing(javax.swing.event.InternalFrameEvent evt) {
            }
            public void internalFrameDeactivated(javax.swing.event.InternalFrameEvent evt) {
            }
            public void internalFrameDeiconified(javax.swing.event.InternalFrameEvent evt) {
            }
            public void internalFrameIconified(javax.swing.event.InternalFrameEvent evt) {
            }
            public void internalFrameOpened(javax.swing.event.InternalFrameEvent evt) {
                formInternalFrameOpened(evt);
            }
        });

        tbpMainPanel.addAncestorListener(new javax.swing.event.AncestorListener() {
            public void ancestorMoved(javax.swing.event.AncestorEvent evt) {
            }
            public void ancestorAdded(javax.swing.event.AncestorEvent evt) {
                tbpMainPanelAncestorAdded(evt);
            }
            public void ancestorRemoved(javax.swing.event.AncestorEvent evt) {
            }
        });

        pnl1.setBackground(new java.awt.Color(255, 255, 255));

        tblSanPhamChiTiet.setFont(new java.awt.Font("Tahoma", 0, 16)); // NOI18N
        tblSanPhamChiTiet.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {"123213213", null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null}
            },
            new String [] {
                "STT", "Tên sản phẩm", "Quy cách", "Độ dài", "Tỉ trọng", "<html><p style='text-align: center'>Tổng<br>khối lượng<p><html>", "<html><p style='text-align:center'>Tổng <br> độ dài</p><html>", "Số lượng", "<html><p style='text-align: center'>Đơn giá<br>lẽ<p><html>", "<html><p style='text-align: center'>Đơn giá<br>sỉ<p><html>", "sp"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false, false, false, false, false, false, false, false, false, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        tblSanPhamChiTiet.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        tblSanPhamChiTiet.setFillsViewportHeight(true);
        tblSanPhamChiTiet.setGridColor(new java.awt.Color(0, 0, 0));
        tblSanPhamChiTiet.setRowHeight(80);
        tblSanPhamChiTiet.addAncestorListener(new javax.swing.event.AncestorListener() {
            public void ancestorMoved(javax.swing.event.AncestorEvent evt) {
            }
            public void ancestorAdded(javax.swing.event.AncestorEvent evt) {
                tblSanPhamChiTietAncestorAdded(evt);
            }
            public void ancestorRemoved(javax.swing.event.AncestorEvent evt) {
            }
        });
        tblSanPhamChiTiet.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                tblSanPhamChiTietMouseClicked(evt);
            }
        });
        clpBangSP1.setViewportView(tblSanPhamChiTiet);
        if (tblSanPhamChiTiet.getColumnModel().getColumnCount() > 0) {
            tblSanPhamChiTiet.getColumnModel().getColumn(0).setMinWidth(50);
            tblSanPhamChiTiet.getColumnModel().getColumn(0).setPreferredWidth(50);
            tblSanPhamChiTiet.getColumnModel().getColumn(0).setMaxWidth(50);
            tblSanPhamChiTiet.getColumnModel().getColumn(2).setMinWidth(70);
            tblSanPhamChiTiet.getColumnModel().getColumn(2).setPreferredWidth(120);
            tblSanPhamChiTiet.getColumnModel().getColumn(2).setMaxWidth(200);
            tblSanPhamChiTiet.getColumnModel().getColumn(3).setMinWidth(50);
            tblSanPhamChiTiet.getColumnModel().getColumn(3).setPreferredWidth(100);
            tblSanPhamChiTiet.getColumnModel().getColumn(3).setMaxWidth(150);
            tblSanPhamChiTiet.getColumnModel().getColumn(4).setMinWidth(100);
            tblSanPhamChiTiet.getColumnModel().getColumn(4).setPreferredWidth(150);
            tblSanPhamChiTiet.getColumnModel().getColumn(4).setMaxWidth(200);
            tblSanPhamChiTiet.getColumnModel().getColumn(5).setMinWidth(100);
            tblSanPhamChiTiet.getColumnModel().getColumn(5).setPreferredWidth(150);
            tblSanPhamChiTiet.getColumnModel().getColumn(5).setMaxWidth(270);
            tblSanPhamChiTiet.getColumnModel().getColumn(6).setMinWidth(100);
            tblSanPhamChiTiet.getColumnModel().getColumn(6).setPreferredWidth(150);
            tblSanPhamChiTiet.getColumnModel().getColumn(6).setMaxWidth(270);
            tblSanPhamChiTiet.getColumnModel().getColumn(7).setMinWidth(50);
            tblSanPhamChiTiet.getColumnModel().getColumn(7).setPreferredWidth(170);
            tblSanPhamChiTiet.getColumnModel().getColumn(7).setMaxWidth(200);
            tblSanPhamChiTiet.getColumnModel().getColumn(8).setMinWidth(100);
            tblSanPhamChiTiet.getColumnModel().getColumn(8).setPreferredWidth(150);
            tblSanPhamChiTiet.getColumnModel().getColumn(8).setMaxWidth(300);
            tblSanPhamChiTiet.getColumnModel().getColumn(9).setMinWidth(100);
            tblSanPhamChiTiet.getColumnModel().getColumn(9).setPreferredWidth(150);
            tblSanPhamChiTiet.getColumnModel().getColumn(9).setMaxWidth(300);
            tblSanPhamChiTiet.getColumnModel().getColumn(10).setMinWidth(0);
            tblSanPhamChiTiet.getColumnModel().getColumn(10).setPreferredWidth(0);
            tblSanPhamChiTiet.getColumnModel().getColumn(10).setMaxWidth(0);
        }

        txtTimKiem.setFont(new java.awt.Font("Tahoma", 2, 14)); // NOI18N
        txtTimKiem.setText("Tìm kiếm");
        txtTimKiem.setName("Tìm kiếm"); // NOI18N
        txtTimKiem.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                txtTimKiemFocusGained(evt);
            }
        });
        txtTimKiem.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtTimKiemActionPerformed(evt);
            }
        });

        btnLoadLaiBang.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        btnLoadLaiBang.setForeground(new java.awt.Color(0, 102, 102));
        btnLoadLaiBang.setIcon(new javax.swing.ImageIcon(getClass().getResource("/images/icons8_sync_30px.png"))); // NOI18N
        btnLoadLaiBang.setText("LÀM MỚI");
        btnLoadLaiBang.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnLoadLaiBangActionPerformed(evt);
            }
        });

        pnlDangNhapDangXuat.setBackground(new java.awt.Color(255, 255, 255));
        pnlDangNhapDangXuat.setLayout(new java.awt.CardLayout());

        pnlDangNhap.setBackground(new java.awt.Color(255, 255, 255));

        txtPass.setFont(new java.awt.Font("Tahoma", 1, 16)); // NOI18N
        txtPass.setHorizontalAlignment(javax.swing.JTextField.CENTER);
        txtPass.setText("admin");
        txtPass.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "MẬT KHẨU", javax.swing.border.TitledBorder.LEADING, javax.swing.border.TitledBorder.TOP, new java.awt.Font("Tahoma", 1, 14), new java.awt.Color(153, 153, 153))); // NOI18N
        txtPass.setSelectedTextColor(new java.awt.Color(51, 51, 51));
        txtPass.setSelectionColor(new java.awt.Color(255, 204, 153));
        txtPass.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                txtPassFocusGained(evt);
            }
        });
        txtPass.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtPassActionPerformed(evt);
            }
        });

        jLabel15.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        jLabel15.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel15.setText("<html><p style='text-align: right'>Đăng nhập để thực hiện chức năng admin</p><html>");

        javax.swing.GroupLayout pnlDangNhapLayout = new javax.swing.GroupLayout(pnlDangNhap);
        pnlDangNhap.setLayout(pnlDangNhapLayout);
        pnlDangNhapLayout.setHorizontalGroup(
            pnlDangNhapLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, pnlDangNhapLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel15, javax.swing.GroupLayout.PREFERRED_SIZE, 163, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(txtPass, javax.swing.GroupLayout.DEFAULT_SIZE, 136, Short.MAX_VALUE))
        );
        pnlDangNhapLayout.setVerticalGroup(
            pnlDangNhapLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jLabel15)
            .addComponent(txtPass, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, 0, Short.MAX_VALUE)
        );

        pnlDangNhapDangXuat.add(pnlDangNhap, "card2");

        pnlDangXuat.setBackground(new java.awt.Color(255, 255, 255));
        pnlDangXuat.setOpaque(false);
        pnlDangXuat.addComponentListener(new java.awt.event.ComponentAdapter() {
            public void componentShown(java.awt.event.ComponentEvent evt) {
                pnlDangXuatComponentShown(evt);
            }
        });

        jButton1.setBackground(new java.awt.Color(153, 0, 51));
        jButton1.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        jButton1.setForeground(new java.awt.Color(204, 204, 204));
        jButton1.setText("ĐĂNG XUẤT");
        jButton1.addComponentListener(new java.awt.event.ComponentAdapter() {
            public void componentShown(java.awt.event.ComponentEvent evt) {
                jButton1ComponentShown(evt);
            }
        });
        jButton1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton1ActionPerformed(evt);
            }
        });

        jLabel14.setFont(new java.awt.Font("Tahoma", 2, 14)); // NOI18N
        jLabel14.setForeground(new java.awt.Color(153, 0, 0));
        jLabel14.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel14.setText("Admin đăng nhập...");

        javax.swing.GroupLayout pnlDangXuatLayout = new javax.swing.GroupLayout(pnlDangXuat);
        pnlDangXuat.setLayout(pnlDangXuatLayout);
        pnlDangXuatLayout.setHorizontalGroup(
            pnlDangXuatLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, pnlDangXuatLayout.createSequentialGroup()
                .addComponent(jLabel14, javax.swing.GroupLayout.DEFAULT_SIZE, 166, Short.MAX_VALUE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(jButton1)
                .addGap(21, 21, 21))
        );
        pnlDangXuatLayout.setVerticalGroup(
            pnlDangXuatLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jLabel14, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
            .addComponent(jButton1, javax.swing.GroupLayout.DEFAULT_SIZE, 47, Short.MAX_VALUE)
        );

        pnlDangNhapDangXuat.add(pnlDangXuat, "card3");

        jSeparator3.setOrientation(javax.swing.SwingConstants.VERTICAL);

        javax.swing.GroupLayout pnl1Layout = new javax.swing.GroupLayout(pnl1);
        pnl1.setLayout(pnl1Layout);
        pnl1Layout.setHorizontalGroup(
            pnl1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(pnl1Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(pnl1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(clpBangSP1)
                    .addGroup(pnl1Layout.createSequentialGroup()
                        .addComponent(txtTimKiem, javax.swing.GroupLayout.PREFERRED_SIZE, 463, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 632, Short.MAX_VALUE)
                        .addComponent(jSeparator3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(pnlDangNhapDangXuat, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(btnLoadLaiBang)))
                .addContainerGap())
        );
        pnl1Layout.setVerticalGroup(
            pnl1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(pnl1Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(pnl1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(pnlDangNhapDangXuat, javax.swing.GroupLayout.PREFERRED_SIZE, 0, Short.MAX_VALUE)
                    .addComponent(btnLoadLaiBang, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(txtTimKiem)
                    .addComponent(jSeparator3))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(clpBangSP1, javax.swing.GroupLayout.PREFERRED_SIZE, 817, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );

        tbpMainPanel.addTab("Danh sách sản phẩm", pnl1);

        tblSanPhamSua.setFont(new java.awt.Font("Calibri", 0, 18)); // NOI18N
        tblSanPhamSua.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {"123213213", null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null}
            },
            new String [] {
                "STT", "Tên sản phẩm", "Quy cách", "Độ dài", "Tỉ trọng", "Tổng khối lượng", "Tổng độ dài", "Số lượng", "Đơn giá lẽ", "Đơn giá sỉ", "sp"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false, false, false, false, false, false, false, false, false, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        tblSanPhamSua.setFillsViewportHeight(true);
        tblSanPhamSua.setGridColor(new java.awt.Color(0, 0, 0));
        tblSanPhamSua.setRowHeight(80);
        tblSanPhamSua.setSelectionBackground(new java.awt.Color(153, 153, 153));
        tblSanPhamSua.addAncestorListener(new javax.swing.event.AncestorListener() {
            public void ancestorMoved(javax.swing.event.AncestorEvent evt) {
            }
            public void ancestorAdded(javax.swing.event.AncestorEvent evt) {
                tblSanPhamSuaAncestorAdded(evt);
            }
            public void ancestorRemoved(javax.swing.event.AncestorEvent evt) {
            }
        });
        tblSanPhamSua.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                tblSanPhamSuaMouseClicked(evt);
            }
        });
        jScrollPane2.setViewportView(tblSanPhamSua);
        if (tblSanPhamSua.getColumnModel().getColumnCount() > 0) {
            tblSanPhamSua.getColumnModel().getColumn(0).setMinWidth(50);
            tblSanPhamSua.getColumnModel().getColumn(0).setPreferredWidth(50);
            tblSanPhamSua.getColumnModel().getColumn(0).setMaxWidth(50);
            tblSanPhamSua.getColumnModel().getColumn(2).setMinWidth(50);
            tblSanPhamSua.getColumnModel().getColumn(2).setPreferredWidth(100);
            tblSanPhamSua.getColumnModel().getColumn(2).setMaxWidth(170);
            tblSanPhamSua.getColumnModel().getColumn(3).setMinWidth(50);
            tblSanPhamSua.getColumnModel().getColumn(3).setPreferredWidth(70);
            tblSanPhamSua.getColumnModel().getColumn(3).setMaxWidth(140);
            tblSanPhamSua.getColumnModel().getColumn(4).setMinWidth(100);
            tblSanPhamSua.getColumnModel().getColumn(4).setPreferredWidth(150);
            tblSanPhamSua.getColumnModel().getColumn(4).setMaxWidth(200);
            tblSanPhamSua.getColumnModel().getColumn(5).setMinWidth(0);
            tblSanPhamSua.getColumnModel().getColumn(5).setPreferredWidth(0);
            tblSanPhamSua.getColumnModel().getColumn(5).setMaxWidth(0);
            tblSanPhamSua.getColumnModel().getColumn(6).setMinWidth(0);
            tblSanPhamSua.getColumnModel().getColumn(6).setPreferredWidth(0);
            tblSanPhamSua.getColumnModel().getColumn(6).setMaxWidth(0);
            tblSanPhamSua.getColumnModel().getColumn(7).setMinWidth(100);
            tblSanPhamSua.getColumnModel().getColumn(7).setPreferredWidth(150);
            tblSanPhamSua.getColumnModel().getColumn(7).setMaxWidth(200);
            tblSanPhamSua.getColumnModel().getColumn(8).setMinWidth(100);
            tblSanPhamSua.getColumnModel().getColumn(8).setPreferredWidth(150);
            tblSanPhamSua.getColumnModel().getColumn(8).setMaxWidth(200);
            tblSanPhamSua.getColumnModel().getColumn(9).setMinWidth(100);
            tblSanPhamSua.getColumnModel().getColumn(9).setPreferredWidth(150);
            tblSanPhamSua.getColumnModel().getColumn(9).setMaxWidth(200);
            tblSanPhamSua.getColumnModel().getColumn(10).setMinWidth(0);
            tblSanPhamSua.getColumnModel().getColumn(10).setPreferredWidth(0);
            tblSanPhamSua.getColumnModel().getColumn(10).setMaxWidth(0);
        }

        jPanel3.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)));
        jPanel3.setLayout(new java.awt.BorderLayout());

        jLabel8.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        jLabel8.setText("Khác:");

        jLabel9.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        jLabel9.setText("Giá sỉ:");

        jLabel6.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        jLabel6.setText("Độ dày:");

        jLabel11.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        jLabel11.setText("Giá lẽ");

        jLabel1.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        jLabel1.setText("<html>Tên nhà<br>cung cấp<html>:");

        jButton3.setIcon(new javax.swing.ImageIcon(getClass().getResource("/images/icons8_add_24px.png"))); // NOI18N
        jButton3.setContentAreaFilled(false);
        jButton3.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        jButton3.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton3ActionPerformed(evt);
            }
        });

        cbbGiaLe.setFont(new java.awt.Font("Calibri", 0, 18)); // NOI18N
        cbbGiaLe.setForeground(new java.awt.Color(0, 0, 102));
        cbbGiaLe.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "Chọn đơn vị tính", " " }));
        HoTro.fillCombobox(loai, cbbDvt);
        cbbGiaLe.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                cbbGiaLeFocusGained(evt);
            }
        });

        cbbDvt.setFont(new java.awt.Font("Calibri", 0, 18)); // NOI18N
        cbbDvt.setForeground(new java.awt.Color(0, 0, 102));
        cbbDvt.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "Item 1", "Item 2", "Item 3", "Item 4" }));
        HoTro.fillCombobox(loai, cbbDvt);
        cbbDvt.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                cbbDvtItemStateChanged(evt);
            }
        });

        txtKhac.setFont(new java.awt.Font("Calibri", 0, 18)); // NOI18N
        txtKhac.setForeground(new java.awt.Color(0, 0, 102));
        txtKhac.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                txtKhacFocusGained(evt);
            }
        });

        cbbTrongLuong.setFont(new java.awt.Font("Calibri", 0, 18)); // NOI18N
        cbbTrongLuong.setForeground(new java.awt.Color(0, 0, 102));
        cbbTrongLuong.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "Item 1", "Item 2", "Item 3", "Item 4" }));
        HoTro.fillCombobox(trongLuong, cbbTrongLuong);
        cbbTrongLuong.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                cbbTrongLuongItemStateChanged(evt);
            }
        });

        jLabel5.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        jLabel5.setText("<html>Trọng<br>lượng<html>");

        cbbDay.setFont(new java.awt.Font("Calibri", 0, 18)); // NOI18N
        cbbDay.setForeground(new java.awt.Color(0, 0, 102));
        cbbDay.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "Item 1", "Item 2", "Item 3", "Item 4" }));
        HoTro.fillCombobox(khoangCach, cbbDay);

        jLabel2.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        jLabel2.setText("<html>Danh mục<br>sản phẩm<html>");

        txtGiaLe.setForeground(new java.awt.Color(0, 0, 102));
        txtGiaLe.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.NumberFormatter()));
        txtGiaLe.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        txtGiaLe.setFont(new java.awt.Font("Calibri", 0, 18)); // NOI18N
        txtGiaLe.setValue(0);
        txtGiaLe.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                txtGiaLeFocusGained(evt);
            }
        });

        jLabel10.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        jLabel10.setText("vnd /");

        cbbDanhMucSP.setFont(new java.awt.Font("Calibri", 0, 18)); // NOI18N
        cbbDanhMucSP.setForeground(new java.awt.Color(0, 0, 102));
        cbbDanhMucSP.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "Item 1", "Item 2", "Item 3", "Item 4" }));
        HoTro.fillCombobox(listDanhMucSystem, cbbDanhMucSP);

        jLabel7.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        jLabel7.setText("Độ dài");

        txtTenSP.setFont(new java.awt.Font("Calibri", 0, 18)); // NOI18N
        txtTenSP.setForeground(new java.awt.Color(0, 0, 102));
        txtTenSP.addCaretListener(new javax.swing.event.CaretListener() {
            public void caretUpdate(javax.swing.event.CaretEvent evt) {
                txtTenSPCaretUpdate(evt);
            }
        });
        txtTenSP.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                txtTenSPFocusGained(evt);
            }
        });
        txtTenSP.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtTenSPActionPerformed(evt);
            }
        });

        jLabel3.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        jLabel3.setText("<html>Tên<br>sản phẩm<html>");

        txtQuyCach.setFont(new java.awt.Font("Calibri", 0, 18)); // NOI18N
        txtQuyCach.setForeground(new java.awt.Color(0, 0, 102));
        txtQuyCach.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                txtQuyCachFocusGained(evt);
            }
        });

        jLabel4.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        jLabel4.setText("Quy cách: ");

        txtGia.setForeground(new java.awt.Color(0, 0, 102));
        txtGia.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.NumberFormatter()));
        txtGia.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        txtGia.setFont(new java.awt.Font("Calibri", 0, 18)); // NOI18N
        txtGia.setSelectionEnd(txtGia.getText().length()-1);
        txtGia.setValue(0);
        txtGia.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                txtGiaFocusGained(evt);
            }
        });

        txtTrongLuong.setForeground(new java.awt.Color(0, 0, 102));
        txtTrongLuong.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.NumberFormatter()));
        txtTrongLuong.setFont(new java.awt.Font("Calibri", 0, 18)); // NOI18N
        txtTrongLuong.setValue(0);
        txtTrongLuong.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                txtTrongLuongFocusGained(evt);
            }
        });

        cbbNhaCungCap.setFont(new java.awt.Font("Calibri", 0, 18)); // NOI18N
        cbbNhaCungCap.setForeground(new java.awt.Color(0, 0, 102));
        cbbNhaCungCap.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "Item 1", "Item 2", "Item 3", "Item 4" }));
        HoTro.fillCombobox(listNccSystem, cbbNhaCungCap);

        cbbDai.setFont(new java.awt.Font("Calibri", 0, 18)); // NOI18N
        cbbDai.setForeground(new java.awt.Color(0, 0, 102));
        cbbDai.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "Item 1", "Item 2", "Item 3", "Item 4" }));
        HoTro.fillCombobox(khoangCach, cbbDai);
        cbbDai.setSelectedIndex(2);
        cbbDai.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                cbbDaiItemStateChanged(evt);
            }
        });

        jButton2.setIcon(new javax.swing.ImageIcon(getClass().getResource("/images/icons8_add_24px.png"))); // NOI18N
        jButton2.setContentAreaFilled(false);
        jButton2.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        jButton2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton2ActionPerformed(evt);
            }
        });

        jLabel12.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        jLabel12.setText("vnd /");

        txtDay.setForeground(new java.awt.Color(0, 0, 102));
        txtDay.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.NumberFormatter()));
        txtDay.setFont(new java.awt.Font("Calibri", 0, 18)); // NOI18N
        txtDay.setValue(0);
        txtDay.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                txtDayFocusGained(evt);
            }
        });

        txtDai.setForeground(new java.awt.Color(0, 0, 102));
        txtDai.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.NumberFormatter()));
        txtDai.setFont(new java.awt.Font("Calibri", 0, 18)); // NOI18N
        txtDai.setValue(0);
        txtDai.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                txtDaiFocusGained(evt);
            }
        });
        txtDai.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtDaiActionPerformed(evt);
            }
        });

        jButton5.setIcon(new javax.swing.ImageIcon(getClass().getResource("/images/icons8_add_24px.png"))); // NOI18N
        jButton5.setContentAreaFilled(false);
        jButton5.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        jButton5.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton5ActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel4Layout = new javax.swing.GroupLayout(jPanel4);
        jPanel4.setLayout(jPanel4Layout);
        jPanel4Layout.setHorizontalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel4Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jSeparator2)
                    .addComponent(jSeparator1)
                    .addGroup(jPanel4Layout.createSequentialGroup()
                        .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addGroup(jPanel4Layout.createSequentialGroup()
                                .addComponent(jLabel5, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(18, 18, 18)
                                .addComponent(txtTrongLuong, javax.swing.GroupLayout.PREFERRED_SIZE, 49, javax.swing.GroupLayout.PREFERRED_SIZE)))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(cbbTrongLuong, javax.swing.GroupLayout.PREFERRED_SIZE, 85, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(jLabel7)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(txtDai, javax.swing.GroupLayout.PREFERRED_SIZE, 60, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(cbbDai, 0, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                    .addGroup(jPanel4Layout.createSequentialGroup()
                        .addGap(87, 87, 87)
                        .addComponent(txtTenSP))
                    .addGroup(jPanel4Layout.createSequentialGroup()
                        .addComponent(jLabel4)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(txtQuyCach, javax.swing.GroupLayout.PREFERRED_SIZE, 98, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(jLabel6)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(txtDay)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(cbbDay, javax.swing.GroupLayout.PREFERRED_SIZE, 83, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(jPanel4Layout.createSequentialGroup()
                        .addComponent(jLabel8)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(txtKhac))
                    .addGroup(jPanel4Layout.createSequentialGroup()
                        .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel4Layout.createSequentialGroup()
                                .addGap(54, 54, 54)
                                .addComponent(txtGiaLe, javax.swing.GroupLayout.PREFERRED_SIZE, 212, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(jLabel12, javax.swing.GroupLayout.PREFERRED_SIZE, 38, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                            .addGroup(jPanel4Layout.createSequentialGroup()
                                .addComponent(jLabel9)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(txtGia, javax.swing.GroupLayout.PREFERRED_SIZE, 181, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(jLabel10)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(cbbDvt, 0, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)))
                        .addComponent(jButton5, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(jPanel4Layout.createSequentialGroup()
                        .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel4Layout.createSequentialGroup()
                                .addComponent(jLabel11)
                                .addGap(285, 285, 285)
                                .addComponent(cbbGiaLe, javax.swing.GroupLayout.PREFERRED_SIZE, 91, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(jPanel4Layout.createSequentialGroup()
                                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                                    .addGroup(jPanel4Layout.createSequentialGroup()
                                        .addComponent(jLabel1, javax.swing.GroupLayout.PREFERRED_SIZE, 74, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                        .addComponent(cbbNhaCungCap, javax.swing.GroupLayout.PREFERRED_SIZE, 286, javax.swing.GroupLayout.PREFERRED_SIZE))
                                    .addGroup(jPanel4Layout.createSequentialGroup()
                                        .addComponent(jLabel2, javax.swing.GroupLayout.PREFERRED_SIZE, 75, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                        .addComponent(cbbDanhMucSP, javax.swing.GroupLayout.PREFERRED_SIZE, 285, javax.swing.GroupLayout.PREFERRED_SIZE)))
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(jButton3, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addComponent(jButton2, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE))))
                        .addGap(0, 0, Short.MAX_VALUE)))
                .addContainerGap())
        );
        jPanel4Layout.setVerticalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel4Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(jButton2)
                    .addComponent(jLabel1)
                    .addComponent(cbbNhaCungCap))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(cbbDanhMucSP, javax.swing.GroupLayout.PREFERRED_SIZE, 34, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(jButton3, javax.swing.GroupLayout.PREFERRED_SIZE, 34, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addGroup(jPanel4Layout.createSequentialGroup()
                        .addGap(2, 2, 2)
                        .addComponent(txtTenSP))
                    .addComponent(jLabel3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(jSeparator1, javax.swing.GroupLayout.PREFERRED_SIZE, 8, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                    .addComponent(txtDay)
                    .addComponent(jLabel6, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(txtQuyCach, javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel4, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(cbbDay, javax.swing.GroupLayout.DEFAULT_SIZE, 36, Short.MAX_VALUE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(cbbDai, javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(txtDai, javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(jLabel7, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jLabel5)
                    .addComponent(txtTrongLuong)
                    .addComponent(cbbTrongLuong))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(jLabel8, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(txtKhac, javax.swing.GroupLayout.DEFAULT_SIZE, 34, Short.MAX_VALUE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(jSeparator2, javax.swing.GroupLayout.PREFERRED_SIZE, 8, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(jLabel9, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(txtGia, javax.swing.GroupLayout.PREFERRED_SIZE, 38, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(jLabel10, javax.swing.GroupLayout.PREFERRED_SIZE, 38, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(cbbDvt, javax.swing.GroupLayout.PREFERRED_SIZE, 39, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(jButton5, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(jLabel12, javax.swing.GroupLayout.PREFERRED_SIZE, 41, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(cbbGiaLe, javax.swing.GroupLayout.PREFERRED_SIZE, 42, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(txtGiaLe)
                    .addComponent(jLabel11, javax.swing.GroupLayout.PREFERRED_SIZE, 42, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap())
        );

        jPanel3.add(jPanel4, java.awt.BorderLayout.CENTER);

        jPanel5.setBackground(new java.awt.Color(153, 153, 153));
        jPanel5.setBorder(javax.swing.BorderFactory.createMatteBorder(0, 0, 1, 0, new java.awt.Color(0, 0, 0)));
        jPanel5.setForeground(new java.awt.Color(102, 102, 102));
        jPanel5.setPreferredSize(new java.awt.Dimension(434, 50));

        jLabel13.setBackground(new java.awt.Color(153, 153, 153));
        jLabel13.setFont(new java.awt.Font("Tahoma", 1, 16)); // NOI18N
        jLabel13.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel13.setText("THÔNG TIN SẢN PHẨM");
        jLabel13.setPreferredSize(new java.awt.Dimension(187, 50));

        jButton4.setIcon(new javax.swing.ImageIcon(getClass().getResource("/images/icons8_sync_30px.png"))); // NOI18N
        jButton4.setContentAreaFilled(false);
        jButton4.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        jButton4.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton4ActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel5Layout = new javax.swing.GroupLayout(jPanel5);
        jPanel5.setLayout(jPanel5Layout);
        jPanel5Layout.setHorizontalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel5Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel13, javax.swing.GroupLayout.PREFERRED_SIZE, 261, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 98, Short.MAX_VALUE)
                .addComponent(jButton4))
        );
        jPanel5Layout.setVerticalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel5Layout.createSequentialGroup()
                .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jButton4, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addGroup(jPanel5Layout.createSequentialGroup()
                        .addComponent(jLabel13, javax.swing.GroupLayout.PREFERRED_SIZE, 44, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(0, 0, Short.MAX_VALUE)))
                .addContainerGap())
        );

        jPanel3.add(jPanel5, java.awt.BorderLayout.NORTH);

        btnThem1.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        btnThem1.setForeground(new java.awt.Color(0, 153, 0));
        btnThem1.setIcon(new javax.swing.ImageIcon(getClass().getResource("/images/icons8_xls_import_48px.png"))); // NOI18N
        btnThem1.setText("<html><span>NHẬP BẰNG EXCEL</span><html>");
        btnThem1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnThem1ActionPerformed(evt);
            }
        });

        btnThemExcel.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        btnThemExcel.setForeground(new java.awt.Color(0, 153, 0));
        btnThemExcel.setIcon(new javax.swing.ImageIcon(getClass().getResource("/images/icons8_xls_export_48px.png"))); // NOI18N
        btnThemExcel.setText("<html><p>XUẤT FILE EXCEL MẪU</p><html>");
        btnThemExcel.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnThemExcelActionPerformed(evt);
            }
        });

        btnThem.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        btnThem.setForeground(new java.awt.Color(0, 153, 0));
        btnThem.setIcon(new javax.swing.ImageIcon(getClass().getResource("/images/icons8_add_60px_1.png"))); // NOI18N
        btnThem.setText("Thêm");
        btnThem.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnThemActionPerformed(evt);
            }
        });

        btnSua.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        btnSua.setForeground(new java.awt.Color(0, 51, 153));
        btnSua.setIcon(new javax.swing.ImageIcon(getClass().getResource("/images/icons8_design_60px.png"))); // NOI18N
        btnSua.setText("Sửa");
        btnSua.setEnabled(false);
        btnSua.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnSuaActionPerformed(evt);
            }
        });

        btnXoa.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        btnXoa.setForeground(new java.awt.Color(204, 0, 51));
        btnXoa.setIcon(new javax.swing.ImageIcon(getClass().getResource("/images/icons8_delete_60px.png"))); // NOI18N
        btnXoa.setText("Xóa");
        btnXoa.setEnabled(false);
        btnXoa.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnXoaActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addGap(6, 6, 6)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addComponent(btnThem, javax.swing.GroupLayout.PREFERRED_SIZE, 138, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(btnSua, javax.swing.GroupLayout.PREFERRED_SIZE, 136, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(btnXoa, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addComponent(btnThemExcel, javax.swing.GroupLayout.PREFERRED_SIZE, 195, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(btnThem1, javax.swing.GroupLayout.PREFERRED_SIZE, 176, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addGap(16, 16, 16))
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(btnThem)
                    .addComponent(btnSua)
                    .addComponent(btnXoa))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(btnThemExcel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btnThem1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(39, 39, 39))
        );

        jScrollPane1.setBorder(null);

        jTextArea1.setEditable(false);
        jTextArea1.setBackground(new java.awt.Color(204, 204, 204));
        jTextArea1.setColumns(20);
        jTextArea1.setFont(new java.awt.Font("Tahoma", 2, 14)); // NOI18N
        jTextArea1.setForeground(new java.awt.Color(102, 102, 102));
        jTextArea1.setLineWrap(true);
        jTextArea1.setRows(5);
        jTextArea1.setText("* Lưu ý: \n        - Khi nhập bằng file excel  bắt buộc phải nhập đúng theo định dạng dữ liệu mẫu\n\n        - Khi chọn xuất file excel mâu cần nhớ vị trí lưu\n\n        - Nhập đúng file excel mẫu đã xuất. Không nhập bằng các file excel khác tránh xãy ra lỗi trong quá trình chạy.");
        jTextArea1.setWrapStyleWord(true);
        jScrollPane1.setViewportView(jTextArea1);

        javax.swing.GroupLayout jPanel6Layout = new javax.swing.GroupLayout(jPanel6);
        jPanel6.setLayout(jPanel6Layout);
        jPanel6Layout.setHorizontalGroup(
            jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel6Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                    .addComponent(jPanel1, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel3, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.PREFERRED_SIZE, 436, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jScrollPane1))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        jPanel6Layout.setVerticalGroup(
            jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel6Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jPanel3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, 153, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jScrollPane1, javax.swing.GroupLayout.DEFAULT_SIZE, 227, Short.MAX_VALUE)
                .addContainerGap())
        );

        javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
        jPanel2.setLayout(jPanel2Layout);
        jPanel2Layout.setHorizontalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addComponent(jPanel6, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jScrollPane2, javax.swing.GroupLayout.DEFAULT_SIZE, 1118, Short.MAX_VALUE)
                .addGap(7, 7, 7))
        );
        jPanel2Layout.setVerticalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jPanel6, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jScrollPane2))
                .addContainerGap())
        );

        tbpMainPanel.addTab("Chi tiết sản phâm", jPanel2);

        jPanel13.setEnabled(false);

        tblSPExecel.setFont(new java.awt.Font("Tahoma", 0, 16)); // NOI18N
        tblSPExecel.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {"123213213", null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null}
            },
            new String [] {
                "STT", "Tên sản phẩm", "Quy cách", "Độ dài", "Tỉ trọng", "<html><p style='text-align: center'>Tổng<br>khối lượng<p><html>", "<html><p style='text-align:center'>Tổng <br> độ dài</p><html>", "Số lượng", "<html><p style='text-align: center'>Đơn giá<br>lẽ<p><html>", "<html><p style='text-align: center'>Đơn giá<br>sỉ<p><html>", "sp"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false, false, false, false, false, false, false, false, false, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        tblSPExecel.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        tblSPExecel.setFillsViewportHeight(true);
        tblSPExecel.setGridColor(new java.awt.Color(0, 0, 0));
        tblSPExecel.setRowHeight(80);
        tblSPExecel.addAncestorListener(new javax.swing.event.AncestorListener() {
            public void ancestorMoved(javax.swing.event.AncestorEvent evt) {
            }
            public void ancestorAdded(javax.swing.event.AncestorEvent evt) {
                tblSPExecelAncestorAdded(evt);
            }
            public void ancestorRemoved(javax.swing.event.AncestorEvent evt) {
            }
        });
        tblSPExecel.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                tblSPExecelMouseClicked(evt);
            }
        });
        clpBangSP2.setViewportView(tblSPExecel);
        if (tblSPExecel.getColumnModel().getColumnCount() > 0) {
            tblSPExecel.getColumnModel().getColumn(0).setMinWidth(50);
            tblSPExecel.getColumnModel().getColumn(0).setPreferredWidth(50);
            tblSPExecel.getColumnModel().getColumn(0).setMaxWidth(50);
            tblSPExecel.getColumnModel().getColumn(2).setMinWidth(70);
            tblSPExecel.getColumnModel().getColumn(2).setPreferredWidth(120);
            tblSPExecel.getColumnModel().getColumn(2).setMaxWidth(200);
            tblSPExecel.getColumnModel().getColumn(3).setMinWidth(50);
            tblSPExecel.getColumnModel().getColumn(3).setPreferredWidth(100);
            tblSPExecel.getColumnModel().getColumn(3).setMaxWidth(150);
            tblSPExecel.getColumnModel().getColumn(4).setMinWidth(100);
            tblSPExecel.getColumnModel().getColumn(4).setPreferredWidth(150);
            tblSPExecel.getColumnModel().getColumn(4).setMaxWidth(200);
            tblSPExecel.getColumnModel().getColumn(5).setMinWidth(100);
            tblSPExecel.getColumnModel().getColumn(5).setPreferredWidth(150);
            tblSPExecel.getColumnModel().getColumn(5).setMaxWidth(270);
            tblSPExecel.getColumnModel().getColumn(6).setMinWidth(100);
            tblSPExecel.getColumnModel().getColumn(6).setPreferredWidth(150);
            tblSPExecel.getColumnModel().getColumn(6).setMaxWidth(270);
            tblSPExecel.getColumnModel().getColumn(7).setMinWidth(50);
            tblSPExecel.getColumnModel().getColumn(7).setPreferredWidth(170);
            tblSPExecel.getColumnModel().getColumn(7).setMaxWidth(200);
            tblSPExecel.getColumnModel().getColumn(8).setMinWidth(100);
            tblSPExecel.getColumnModel().getColumn(8).setPreferredWidth(150);
            tblSPExecel.getColumnModel().getColumn(8).setMaxWidth(300);
            tblSPExecel.getColumnModel().getColumn(9).setMinWidth(100);
            tblSPExecel.getColumnModel().getColumn(9).setPreferredWidth(150);
            tblSPExecel.getColumnModel().getColumn(9).setMaxWidth(300);
            tblSPExecel.getColumnModel().getColumn(10).setMinWidth(0);
            tblSPExecel.getColumnModel().getColumn(10).setPreferredWidth(0);
            tblSPExecel.getColumnModel().getColumn(10).setMaxWidth(0);
        }

        jPanel8.setBackground(new java.awt.Color(255, 255, 255));

        jButton6.setFont(new java.awt.Font("Tahoma", 1, 24)); // NOI18N
        jButton6.setText("NHẬP");
        jButton6.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton6ActionPerformed(evt);
            }
        });

        jPanel11.setBackground(new java.awt.Color(255, 255, 255));

        jScrollPane3.setBorder(null);

        jTextArea2.setEditable(false);
        jTextArea2.setColumns(20);
        jTextArea2.setFont(new java.awt.Font("Tahoma", 2, 16)); // NOI18N
        jTextArea2.setForeground(new java.awt.Color(153, 153, 153));
        jTextArea2.setLineWrap(true);
        jTextArea2.setRows(6);
        jTextArea2.setText("Chức năng nhập bằng file excel là tính năng ngoài hệ thống nên việc kiểm tra dữ liệu đầu vào sẽ không thực hiện.\nĐể nhập sản phẩm không bị lỗi vui lòng kiểm tra lại các thông tin sau:\n- Kiểm tra số tại (1) phải bằng tổng số sản phẩm trong file excel muốn nhập.\n- Kiểm tra số tại (2) phải là số dòng cuối cùng trong bảng sản phẩm ở file excel.\n(Bắt đầu là dòng 6)\n");
        jTextArea2.setWrapStyleWord(true);
        jScrollPane3.setViewportView(jTextArea2);

        javax.swing.GroupLayout jPanel11Layout = new javax.swing.GroupLayout(jPanel11);
        jPanel11.setLayout(jPanel11Layout);
        jPanel11Layout.setHorizontalGroup(
            jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel11Layout.createSequentialGroup()
                .addComponent(jScrollPane3, javax.swing.GroupLayout.DEFAULT_SIZE, 577, Short.MAX_VALUE)
                .addGap(12, 12, 12))
        );
        jPanel11Layout.setVerticalGroup(
            jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jScrollPane3, javax.swing.GroupLayout.DEFAULT_SIZE, 261, Short.MAX_VALUE)
        );

        jLabel16.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        jLabel16.setText("Đã sẵn sàng(1): ");

        lblSS.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        lblSS.setText("20");

        jLabel18.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        jLabel18.setText("sản phẩm");

        jLabel19.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        jLabel19.setText("Dừng lại ở dòng(2):");

        lblDung.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        lblDung.setText("20");

        jLabel20.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        jLabel20.setText("trong file excel");

        javax.swing.GroupLayout jPanel12Layout = new javax.swing.GroupLayout(jPanel12);
        jPanel12.setLayout(jPanel12Layout);
        jPanel12Layout.setHorizontalGroup(
            jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel12Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel12Layout.createSequentialGroup()
                        .addComponent(jLabel16)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(lblSS, javax.swing.GroupLayout.PREFERRED_SIZE, 32, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(jLabel18))
                    .addGroup(jPanel12Layout.createSequentialGroup()
                        .addComponent(jLabel19)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(lblDung, javax.swing.GroupLayout.PREFERRED_SIZE, 45, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jLabel20)))
                .addContainerGap(196, Short.MAX_VALUE))
        );
        jPanel12Layout.setVerticalGroup(
            jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel12Layout.createSequentialGroup()
                .addGroup(jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel16, javax.swing.GroupLayout.PREFERRED_SIZE, 26, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(lblSS, javax.swing.GroupLayout.PREFERRED_SIZE, 26, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel18, javax.swing.GroupLayout.PREFERRED_SIZE, 26, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(jLabel20, javax.swing.GroupLayout.DEFAULT_SIZE, 30, Short.MAX_VALUE)
                    .addComponent(jLabel19, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(lblDung, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addGap(0, 0, Short.MAX_VALUE))
        );

        javax.swing.GroupLayout jPanel8Layout = new javax.swing.GroupLayout(jPanel8);
        jPanel8.setLayout(jPanel8Layout);
        jPanel8Layout.setHorizontalGroup(
            jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel8Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jPanel11, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addComponent(jPanel12, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGap(277, 277, 277)
                .addComponent(jButton6, javax.swing.GroupLayout.PREFERRED_SIZE, 179, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );
        jPanel8Layout.setVerticalGroup(
            jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel11, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel8Layout.createSequentialGroup()
                .addGap(24, 24, 24)
                .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(jPanel12, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jButton6, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap())
        );

        javax.swing.GroupLayout jPanel9Layout = new javax.swing.GroupLayout(jPanel9);
        jPanel9.setLayout(jPanel9Layout);
        jPanel9Layout.setHorizontalGroup(
            jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel9Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(clpBangSP2)
                    .addComponent(jPanel8, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap())
        );
        jPanel9Layout.setVerticalGroup(
            jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel9Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(clpBangSP2, javax.swing.GroupLayout.DEFAULT_SIZE, 579, Short.MAX_VALUE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel8, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );

        javax.swing.GroupLayout jPanel7Layout = new javax.swing.GroupLayout(jPanel7);
        jPanel7.setLayout(jPanel7Layout);
        jPanel7Layout.setHorizontalGroup(
            jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel9, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );
        jPanel7Layout.setVerticalGroup(
            jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel9, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );

        jTabbedPane1.addTab("Danh sách đọc được từ excel", jPanel7);

        tblSPExecelLoi.setFont(new java.awt.Font("Tahoma", 0, 16)); // NOI18N
        tblSPExecelLoi.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {"123213213", null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null}
            },
            new String [] {
                "STT", "Tên sản phẩm", "Quy cách", "Độ dài", "Tỉ trọng", "<html><p style='text-align: center'>Tổng<br>khối lượng<p><html>", "<html><p style='text-align:center'>Tổng <br> độ dài</p><html>", "Số lượng", "<html><p style='text-align: center'>Đơn giá<br>lẽ<p><html>", "<html><p style='text-align: center'>Đơn giá<br>sỉ<p><html>", "sp"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false, false, false, false, false, false, false, false, false, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        tblSPExecelLoi.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        tblSPExecelLoi.setFillsViewportHeight(true);
        tblSPExecelLoi.setGridColor(new java.awt.Color(0, 0, 0));
        tblSPExecelLoi.setRowHeight(80);
        tblSPExecelLoi.addAncestorListener(new javax.swing.event.AncestorListener() {
            public void ancestorMoved(javax.swing.event.AncestorEvent evt) {
            }
            public void ancestorAdded(javax.swing.event.AncestorEvent evt) {
                tblSPExecelLoiAncestorAdded(evt);
            }
            public void ancestorRemoved(javax.swing.event.AncestorEvent evt) {
            }
        });
        tblSPExecelLoi.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                tblSPExecelLoiMouseClicked(evt);
            }
        });
        clpBangSP3.setViewportView(tblSPExecelLoi);
        if (tblSPExecelLoi.getColumnModel().getColumnCount() > 0) {
            tblSPExecelLoi.getColumnModel().getColumn(0).setMinWidth(50);
            tblSPExecelLoi.getColumnModel().getColumn(0).setPreferredWidth(50);
            tblSPExecelLoi.getColumnModel().getColumn(0).setMaxWidth(50);
            tblSPExecelLoi.getColumnModel().getColumn(2).setMinWidth(70);
            tblSPExecelLoi.getColumnModel().getColumn(2).setPreferredWidth(120);
            tblSPExecelLoi.getColumnModel().getColumn(2).setMaxWidth(200);
            tblSPExecelLoi.getColumnModel().getColumn(3).setMinWidth(50);
            tblSPExecelLoi.getColumnModel().getColumn(3).setPreferredWidth(100);
            tblSPExecelLoi.getColumnModel().getColumn(3).setMaxWidth(150);
            tblSPExecelLoi.getColumnModel().getColumn(4).setMinWidth(100);
            tblSPExecelLoi.getColumnModel().getColumn(4).setPreferredWidth(150);
            tblSPExecelLoi.getColumnModel().getColumn(4).setMaxWidth(200);
            tblSPExecelLoi.getColumnModel().getColumn(5).setMinWidth(100);
            tblSPExecelLoi.getColumnModel().getColumn(5).setPreferredWidth(150);
            tblSPExecelLoi.getColumnModel().getColumn(5).setMaxWidth(270);
            tblSPExecelLoi.getColumnModel().getColumn(6).setMinWidth(100);
            tblSPExecelLoi.getColumnModel().getColumn(6).setPreferredWidth(150);
            tblSPExecelLoi.getColumnModel().getColumn(6).setMaxWidth(270);
            tblSPExecelLoi.getColumnModel().getColumn(7).setMinWidth(50);
            tblSPExecelLoi.getColumnModel().getColumn(7).setPreferredWidth(170);
            tblSPExecelLoi.getColumnModel().getColumn(7).setMaxWidth(200);
            tblSPExecelLoi.getColumnModel().getColumn(8).setMinWidth(100);
            tblSPExecelLoi.getColumnModel().getColumn(8).setPreferredWidth(150);
            tblSPExecelLoi.getColumnModel().getColumn(8).setMaxWidth(300);
            tblSPExecelLoi.getColumnModel().getColumn(9).setMinWidth(100);
            tblSPExecelLoi.getColumnModel().getColumn(9).setPreferredWidth(150);
            tblSPExecelLoi.getColumnModel().getColumn(9).setMaxWidth(300);
            tblSPExecelLoi.getColumnModel().getColumn(10).setMinWidth(0);
            tblSPExecelLoi.getColumnModel().getColumn(10).setPreferredWidth(0);
            tblSPExecelLoi.getColumnModel().getColumn(10).setMaxWidth(0);
        }

        javax.swing.GroupLayout jPanel10Layout = new javax.swing.GroupLayout(jPanel10);
        jPanel10.setLayout(jPanel10Layout);
        jPanel10Layout.setHorizontalGroup(
            jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel10Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(clpBangSP3, javax.swing.GroupLayout.DEFAULT_SIZE, 1563, Short.MAX_VALUE)
                .addContainerGap())
        );
        jPanel10Layout.setVerticalGroup(
            jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel10Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(clpBangSP3, javax.swing.GroupLayout.PREFERRED_SIZE, 753, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        jTabbedPane1.addTab("Sản phẩm lỗi", jPanel10);

        javax.swing.GroupLayout jPanel13Layout = new javax.swing.GroupLayout(jPanel13);
        jPanel13.setLayout(jPanel13Layout);
        jPanel13Layout.setHorizontalGroup(
            jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 1592, Short.MAX_VALUE)
            .addGroup(jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(jPanel13Layout.createSequentialGroup()
                    .addGap(0, 0, 0)
                    .addComponent(jTabbedPane1)
                    .addGap(0, 0, 0)))
        );
        jPanel13Layout.setVerticalGroup(
            jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 903, Short.MAX_VALUE)
            .addGroup(jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(jPanel13Layout.createSequentialGroup()
                    .addGap(0, 0, 0)
                    .addComponent(jTabbedPane1)
                    .addGap(0, 0, 0)))
        );

        tbpMainPanel.addTab("Nhập sản phẩm bằng file exce", jPanel13);

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(tbpMainPanel)
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(tbpMainPanel)
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void tblSanPhamChiTietAncestorAdded(javax.swing.event.AncestorEvent evt) {//GEN-FIRST:event_tblSanPhamChiTietAncestorAdded

    }//GEN-LAST:event_tblSanPhamChiTietAncestorAdded

    private void txtTimKiemFocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtTimKiemFocusGained
        txtTimKiem.selectAll();
    }//GEN-LAST:event_txtTimKiemFocusGained

    private void txtTimKiemActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtTimKiemActionPerformed
        sanPhamCtrl.LoadBangSanPham(tblSanPhamChiTiet, txtTimKiem.getText());
    }//GEN-LAST:event_txtTimKiemActionPerformed

    private void btnLoadLaiBangActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnLoadLaiBangActionPerformed
        sanPhamCtrl.LoadBangSanPham(tblSanPhamChiTiet, "");
        txtTimKiem.setText(txtTimKiem.getName());
    }//GEN-LAST:event_btnLoadLaiBangActionPerformed

    private void btnThemActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnThemActionPerformed
        CheckAndInsert();
    }//GEN-LAST:event_btnThemActionPerformed

    private void btnSuaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnSuaActionPerformed
        if (CheckAndUpdate()) {
            reFresh();
        }
    }//GEN-LAST:event_btnSuaActionPerformed

    private void btnXoaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnXoaActionPerformed

        if (tblSanPhamSua.getSelectedRowCount() > 0) {
            dtoSanPham sanPham = (dtoSanPham) tblSanPhamSua.getValueAt(tblSanPhamSua.getSelectedRow(), 10);
            int tb = ThongBao.ThongBaoLoai2("<html>Bạn có chắc muốn xóa sản phẩm:<br> <p style='font-size: 24px; color: red'>" + sanPham.getTenSanPham() + "</p><html>", "Xóa");
            if (tb == JOptionPane.OK_OPTION) {
                if (sanPhamCtrl.XoaSanPham(sanPham)) {
                    ThongBao.ThongBao("Đã xóa", "Thông báo");
                    reFresh();
                } else {
                    ThongBao.ThongBao("Chưa xóa được sản phẩm!", "Thông báo");
                }
            }
        }
    }//GEN-LAST:event_btnXoaActionPerformed

    private void jButton3ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton3ActionPerformed
        String ncc = JOptionPane.showInputDialog(this, "Thêm danh mục sản phẩm mới", "Thêm danh mục", 1);

        try {
            if (!ncc.trim().isEmpty()) {
                listDanhMucSystem.add(ncc);
                cbbDanhMucSP.addItem(ncc);
                cbbDanhMucSP.revalidate();
                cbbDanhMucSP.repaint();
                cbbDanhMucSP.setSelectedItem(ncc);
            }
        } catch (Exception e) {
        }

    }//GEN-LAST:event_jButton3ActionPerformed

    private void cbbGiaLeFocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_cbbGiaLeFocusGained
        dvtGiaLe();
    }//GEN-LAST:event_cbbGiaLeFocusGained

    private void cbbDvtItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_cbbDvtItemStateChanged
        if (cbbDvt.getItemCount() > 0) {
            dvtGiaLe();
        }
    }//GEN-LAST:event_cbbDvtItemStateChanged

    private void txtKhacFocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtKhacFocusGained
        txtKhac.selectAll();
    }//GEN-LAST:event_txtKhacFocusGained

    private void cbbTrongLuongItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_cbbTrongLuongItemStateChanged
        if (cbbTrongLuong.getItemCount() > 0) {
            dvtGiaLe();
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_cbbTrongLuongItemStateChanged

    private void txtGiaLeFocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtGiaLeFocusGained
        txtGiaLe.setText(txtGiaLe.getValue().toString());
        txtGiaLe.selectAll();
    }//GEN-LAST:event_txtGiaLeFocusGained

    private void txtTenSPCaretUpdate(javax.swing.event.CaretEvent evt) {//GEN-FIRST:event_txtTenSPCaretUpdate
        if (btnSua.isEnabled()) {
            btnThem.setEnabled(false);
            return;
        }
        if (!txtTenSP.getText().trim().isEmpty()) {
            btnThem.setEnabled(true);
            return;
        }
        if (txtTenSP.getText().trim().isEmpty()) {
            btnThem.setEnabled(false);
            return;
        }
    }//GEN-LAST:event_txtTenSPCaretUpdate

    private void txtTenSPFocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtTenSPFocusGained
        txtTenSP.selectAll();
    }//GEN-LAST:event_txtTenSPFocusGained

    private void txtTenSPActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtTenSPActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtTenSPActionPerformed

    private void txtQuyCachFocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtQuyCachFocusGained
        txtQuyCach.selectAll();
    }//GEN-LAST:event_txtQuyCachFocusGained

    private void txtGiaFocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtGiaFocusGained
        txtGia.setText(txtGia.getValue().toString());
        txtGia.selectAll();
    }//GEN-LAST:event_txtGiaFocusGained

    private void txtTrongLuongFocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtTrongLuongFocusGained
        txtTrongLuong.setText(txtTrongLuong.getValue().toString());
        txtTrongLuong.selectAll();
    }//GEN-LAST:event_txtTrongLuongFocusGained

    private void cbbDaiItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_cbbDaiItemStateChanged
        if (cbbDai.getItemCount() > 0) {
            dvtGiaLe();
        }
    }//GEN-LAST:event_cbbDaiItemStateChanged

    private void jButton2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton2ActionPerformed
        String ncc = JOptionPane.showInputDialog(this, "Thêm nhà cung cấp mới", "Thêm nhà cung cấp", 1);
        try {
            if (!ncc.trim().isEmpty()) {
                listNccSystem.add(ncc);
                cbbNhaCungCap.addItem(ncc);
                cbbNhaCungCap.revalidate();
                cbbNhaCungCap.repaint();
                cbbNhaCungCap.setSelectedItem(ncc);
            }
        } catch (Exception e) {
        }

    }//GEN-LAST:event_jButton2ActionPerformed

    private void txtDayFocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtDayFocusGained
        txtDay.setText(txtDay.getValue().toString());
        txtDay.selectAll();
    }//GEN-LAST:event_txtDayFocusGained

    private void txtDaiFocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtDaiFocusGained
        txtDai.setText(txtDai.getValue().toString());
        txtDai.selectAll();
    }//GEN-LAST:event_txtDaiFocusGained

    private void txtDaiActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtDaiActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtDaiActionPerformed

    private void jButton5ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton5ActionPerformed
        String dvtGiaSi = JOptionPane.showInputDialog(this, "Thêm mới đơn vị tính giá sỉ", "Thêm đơn vị tính", 1);

        try {
            if (!dvtGiaSi.trim().isEmpty()) {
                if (!sanPhamCtrl.ThemDonViTinhGia(dvtGiaSi)) {
                    ThongBao.ThongBao("<html>Chưa thêm được đơn vị tính<br><span style='color: red'>*Chú ý: </span>Thử kiểm tra xem đơn vị tính đã tồn tại chưa</html>", "Thông báo");
                    return;
                }
                loai.add(dvtGiaSi);
                cbbDvt.addItem(dvtGiaSi);
                cbbDvt.revalidate();
                cbbDvt.repaint();
                cbbDvt.setSelectedItem(dvtGiaSi);

            }
        } catch (Exception e) {
        }
    }//GEN-LAST:event_jButton5ActionPerformed

    private void jButton4ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton4ActionPerformed
        reFresh();
    }//GEN-LAST:event_jButton4ActionPerformed

    private void tbpMainPanelAncestorAdded(javax.swing.event.AncestorEvent evt) {//GEN-FIRST:event_tbpMainPanelAncestorAdded
        sanPhamCtrl.LoadBangSanPham(tblSanPhamSua, "");
        sanPhamCtrl.LoadBangSanPham(tblSanPhamChiTiet, "");
    }//GEN-LAST:event_tbpMainPanelAncestorAdded

    private void formInternalFrameOpened(javax.swing.event.InternalFrameEvent evt) {//GEN-FIRST:event_formInternalFrameOpened
       
    }//GEN-LAST:event_formInternalFrameOpened

    private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton1ActionPerformed
        int tb = ThongBao.ThongBaoLoai2("Bạn có chắc chắn muốn đăng xuất không?", "Đăng xuất");
        if (tb == JOptionPane.OK_OPTION) {
            FormMain.login = false;
            DangNhapDangXuat();
        }
    }//GEN-LAST:event_jButton1ActionPerformed

    private void txtPassActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtPassActionPerformed
        String pass = String.valueOf(txtPass.getPassword());
        System.out.println(pass);
        boolean check = daoUserLogin.CheckPass(pass);
        if (check) {
            ThongBao.ThongBao("Đăng nhâp thành công. Bây giờ bạn có thể sửa số lương sản phẩm", "Thông báo");
            DangNhapDangXuat();
            return;
        }
        ThongBao.ThongBao("Sai tên đăng nhập", "Đăng nhập thất bại");
    }//GEN-LAST:event_txtPassActionPerformed

    private void jButton1ComponentShown(java.awt.event.ComponentEvent evt) {//GEN-FIRST:event_jButton1ComponentShown

    }//GEN-LAST:event_jButton1ComponentShown

    private void pnlDangXuatComponentShown(java.awt.event.ComponentEvent evt) {//GEN-FIRST:event_pnlDangXuatComponentShown
        FormMain.login = true;
    }//GEN-LAST:event_pnlDangXuatComponentShown

    private void tblSanPhamChiTietMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tblSanPhamChiTietMouseClicked
        tblSanPhamChiTiet.setToolTipText("Nhấp vào ô số lượng để sửa lại số lượng sản phẩm");
        if (!FormMain.login) {
            tblSanPhamChiTiet.setToolTipText("Cần đăng nhập để sửa chi tiết sản phẩm hơn.");
            return;
        }
        int row, col, x, y;

        PointerInfo a = MouseInfo.getPointerInfo();
        Point b = a.getLocation();
        x = (int) b.getX() - 150;
        y = (int) b.getY() - 35;
        col = tblSanPhamChiTiet.columnAtPoint(evt.getPoint());

        if (tblSanPhamChiTiet.getSelectedRowCount() > 0 && col == 7) {

            row = tblSanPhamChiTiet.getSelectedRow();
            spUpdateSL = (dtoSanPham) tblSanPhamChiTiet.getValueAt(row, 10);
            editSL = new jdlSuaSoLuong(new JFrame(), false);
            editSL.setLocationRelativeTo(tblSanPhamChiTiet);
            editSL.setBounds(x, y, 368, 54);
            editSL.setVisible(true);

        }

    }//GEN-LAST:event_tblSanPhamChiTietMouseClicked

    private void btnThem1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnThem1ActionPerformed
        JFileChooser fileChoose = new JFileChooser();
        int retrival = fileChoose.showSaveDialog(this);
        if (retrival == JFileChooser.APPROVE_OPTION) {
            try {
//                FileWriter fw = new FileWriter(fileChoose.getSelectedFile() + ".txt");
//                fw.write(sb.toString());

                File file = fileChoose.getSelectedFile();
                System.out.println(file);
                if (ExcelIO.ImportSanPham(file)) {
                    tbpMainPanel.getTabComponentAt(2).setEnabled(true);
                    tbpMainPanel.setSelectedIndex(2);
                }
 

            } catch (Exception ex) {
                ex.printStackTrace();
            }
        }
    }//GEN-LAST:event_btnThem1ActionPerformed

    private void btnThemExcelActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnThemExcelActionPerformed

        boolean xuatFileMau = sanPhamCtrl.CopyFileTrongDocument(this, "file-mau.xlsx", "file-Nhap-hang.xlsx");
        if (xuatFileMau) {
            ThongBao.ThongBao("Đã xuất file.", "Thành công");
        }
    }//GEN-LAST:event_btnThemExcelActionPerformed

    private void tblSanPhamSuaMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tblSanPhamSuaMouseClicked
        if (evt.getClickCount() == 2) {
            ClickTable();
            btnXoa.setEnabled(true);
            return;
        }
        if (tblSanPhamSua.getSelectedRowCount() > 0) {
            btnSua.setEnabled(false);
            btnThem.setEnabled(false);
            btnXoa.setEnabled(true);
            componentNull();
        } else {
            btnSua.setEnabled(false);
            btnThem.setEnabled(true);
            btnXoa.setEnabled(false);
            componentNull();
        }
    }//GEN-LAST:event_tblSanPhamSuaMouseClicked

    private void tblSanPhamSuaAncestorAdded(javax.swing.event.AncestorEvent evt) {//GEN-FIRST:event_tblSanPhamSuaAncestorAdded

    }//GEN-LAST:event_tblSanPhamSuaAncestorAdded

    private void txtPassFocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtPassFocusGained
        txtPass.selectAll();
    }//GEN-LAST:event_txtPassFocusGained

    private void tblSPExecelAncestorAdded(javax.swing.event.AncestorEvent evt) {//GEN-FIRST:event_tblSPExecelAncestorAdded
        // TODO add your handling code here:
    }//GEN-LAST:event_tblSPExecelAncestorAdded

    private void tblSPExecelMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tblSPExecelMouseClicked
        // TODO add your handling code here:
    }//GEN-LAST:event_tblSPExecelMouseClicked

    private void jButton6ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton6ActionPerformed

        if (listExcel == null) {
            ThongBao.ThongBao("Chưa nhập file excel lên hệ thông", "Thông báo");
            return;
        } else {
            sanPhamCtrl.fillBangSP(tblSPExecel, listExcel);
            if (tblSPExecel.getRowCount() <= 0) {
                ThongBao.ThongBao("Không có sản phẩm để nhập vào hệ thống", "Thông báo");
                return;
            }
            List<dtoSanPham> rs = sanPhamCtrl.NhapNhieuSanPham(listExcel);
            int slLoi = -1;
            try {
                slLoi = rs.size();
            } catch (Exception e) {
            }
            if (slLoi <= 0 || rs == null) {
                ThongBao.ThongBao("Đã nhập thành công toàn bộ " + listExcel.size() + " sản phẩm", "Thông báo");
            } else {
                JLabel lb = new JLabel("Xem thêm");
                lb.addMouseListener(new MouseAdapter() {

                    @Override
                    public void mouseClicked(MouseEvent e) {
                        tbpMainPanel.setSelectedIndex(3);
                        sanPhamCtrl.fillBangSP(tblSPExecelLoi, rs);
                    }
                });
                ThongBao.ThongBao("Chưa nhập được " + slLoi + " sản phẩm" + lb.getUIClassID(), "Thông báo");
                tbpMainPanel.setSelectedIndex(3);
                sanPhamCtrl.fillBangSP(tblSPExecelLoi, rs);
            }
        }

    }//GEN-LAST:event_jButton6ActionPerformed

    private void tblSPExecelLoiAncestorAdded(javax.swing.event.AncestorEvent evt) {//GEN-FIRST:event_tblSPExecelLoiAncestorAdded
        // TODO add your handling code here:
    }//GEN-LAST:event_tblSPExecelLoiAncestorAdded

    private void tblSPExecelLoiMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tblSPExecelLoiMouseClicked
        // TODO add your handling code here:
    }//GEN-LAST:event_tblSPExecelLoiMouseClicked

    private void formInternalFrameActivated(javax.swing.event.InternalFrameEvent evt) {//GEN-FIRST:event_formInternalFrameActivated
        
    }//GEN-LAST:event_formInternalFrameActivated
    public void CheckAndInsert() {
        if (!ValidateForm.typeString(txtTenSP.getText().trim(), 1, 150)) {
            ThongBao.ThongBao("<html>Sai tên sản phẩm <br> Tên sản phâm không được chứa các kí tự sau: *| <br>Và độ dài không quá 150 kí tự<html>", "Thông báo!");
            return;
        }

        int id = (int) new Date().getTime();
        donViTinh dvt = new donViTinh(cbbDay.getSelectedItem().toString(), cbbDai.getSelectedItem().toString(), cbbTrongLuong.getSelectedItem().toString(), cbbDvt.getSelectedItem().toString(), cbbGiaLe.getSelectedItem().toString());
        dtoThuocTinhSanPham tt = new dtoThuocTinhSanPham(
                txtKhac.getText(), txtQuyCach.getText(), Double.parseDouble(txtTrongLuong.getValue().toString()),
                Double.parseDouble(txtDay.getValue().toString()), Double.parseDouble(txtDai.getValue().toString()), id);
        dtoSanPham sp = new dtoSanPham(
                "SP-" + id, cbbNhaCungCap.getSelectedItem().toString(),
                cbbDanhMucSP.getSelectedItem().toString(), txtTenSP.getText(), dvt.getDonViTinh(), Double.parseDouble(txtGia.getValue().toString()),
                Double.parseDouble(txtGiaLe.getValue().toString()), 0, id, tt);
        if (sanPhamCtrl.NhapSanPham(sp)) {
            ThongBao.ThongBao("Đã thêm sản phẩm thành công!", "Thông báo");
            reFresh();
        } else {
            ThongBao.ThongBao("<html><p style='font-size: 20px; color: red'>Chưa thêm được sản phẩm!</p><html>", "Thông báo");
            reFresh();
        }
    }

    public void componentNull() {
        txtDai.setValue(0);
        txtDay.setValue(0);
        txtGia.setValue(0);
        txtGiaLe.setValue(0);
        txtKhac.setText("");
        txtQuyCach.setText("");
        txtTenSP.setText("");
        txtTrongLuong.setValue(0);
        cbbDai.setSelectedIndex(0);
        cbbDanhMucSP.setSelectedIndex(0);
        cbbDay.setSelectedIndex(0);
        cbbDvt.setSelectedIndex(0);
        cbbGiaLe.setSelectedIndex(0);
        cbbNhaCungCap.setSelectedIndex(0);
        cbbTrongLuong.setSelectedIndex(0);
    }

    public void reFresh() {
        componentNull();
        btnSua.setEnabled(false);
        btnXoa.setEnabled(false);
        btnThem.setEnabled(true);
        sanPhamCtrl.LoadBangSanPham(tblSanPhamSua, "");
        sanPhamCtrl.LoadBangSanPham(tblSanPhamChiTiet, "");
    }

    public boolean CheckAndUpdate() {

        if (!ValidateForm.typeString(txtTenSP.getText().trim(), 1, 150)) {
            ThongBao.ThongBao("<html>Sai tên sản phẩm <br> Tên sản phâm không được chứa các kí tự sau: *| <br>Và độ dài không quá 150 kí tự<html>", "Thông báo!");
            return false;
        }
        int id = sp.getIdThuocTinh();
        donViTinh dvt = new donViTinh(cbbDay.getSelectedItem().toString(), cbbDai.getSelectedItem().toString(), cbbTrongLuong.getSelectedItem().toString(), cbbDvt.getSelectedItem().toString(), cbbGiaLe.getSelectedItem().toString());
        dtoThuocTinhSanPham tt = new dtoThuocTinhSanPham(
                txtKhac.getText(), txtQuyCach.getText(), Double.parseDouble(txtTrongLuong.getValue().toString()),
                Double.parseDouble(txtDay.getValue().toString()), Double.parseDouble(txtDai.getValue().toString()), id);
        dtoSanPham spCapNhat = new dtoSanPham(
                sp.getIdSanPham(), cbbNhaCungCap.getSelectedItem().toString(), cbbDanhMucSP.getSelectedItem().toString(), txtTenSP.getText(), dvt.getDonViTinh(), Double.parseDouble(txtGia.getValue().toString()), Double.parseDouble(txtGiaLe.getValue().toString()), sp.getSoLuong(), id, tt
        );
        if (sanPhamCtrl.SuaSanPham(spCapNhat)) {
            sanPhamCtrl.LoadBangSanPham(tblSanPhamChiTiet, "");
            ThongBao.ThongBao("Cập nhật thành công!", "Thông báo");
            return true;
        } else {
            System.out.println("Chưa sửa được");
            return false;
        }
    }

    public void ClickTable() {
        sp = (dtoSanPham) tblSanPhamSua.getValueAt(tblSanPhamSua.getSelectedRow(), 10);
        dtoThuocTinhSanPham tt = sp.getTtSanPham();
        donViTinh dvt = new donViTinh(sp.getDonViTinh());
        btnSua.setEnabled(true);
        txtDai.setValue(tt.getDai());
        txtDay.setValue(tt.getDoDay());
        txtGia.setValue(sp.getGiaSi());
        txtGiaLe.setValue(sp.getGiaLe());
        txtKhac.setText(tt.getThuocTinhKhac());
        txtQuyCach.setText(tt.getQuyCach());
        txtTenSP.setText(sp.getTenSanPham());
        txtTrongLuong.setValue(tt.getTrongLuong());
        cbbDai.setSelectedItem(dvt.getDai());
        cbbDanhMucSP.setSelectedItem(sp.getTenDanhMuc());
        cbbDay.setSelectedItem(dvt.getDay());
        cbbDvt.setSelectedItem(dvt.getDvtSi());
        cbbGiaLe.setSelectedItem(dvt.getDvtLe());
        cbbNhaCungCap.setSelectedItem(sp.getTenNhaCungCap());
        cbbTrongLuong.setSelectedItem(dvt.getTrongLuong());
        System.out.println(sp.getSoLuong());

    }

    public void dvtGiaLe() {
        listDVTLe = new ArrayList<>();
        listDVTLe.add(cbbDai.getSelectedItem().toString());
        listDVTLe.add(cbbTrongLuong.getSelectedItem().toString());
        listDVTLe.add(cbbDvt.getSelectedItem().toString());
        HoTro.fillCombobox(listDVTLe, cbbGiaLe);
    }

    public void DangNhapDangXuat() {
        CardLayout cl = (CardLayout) pnlDangNhapDangXuat.getLayout();
        cl.next(pnlDangNhapDangXuat);
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton btnLoadLaiBang;
    private javax.swing.JButton btnSua;
    private javax.swing.JButton btnThem;
    private javax.swing.JButton btnThem1;
    private javax.swing.JButton btnThemExcel;
    private javax.swing.JButton btnXoa;
    private javax.swing.JComboBox cbbDai;
    private javax.swing.JComboBox cbbDanhMucSP;
    private javax.swing.JComboBox cbbDay;
    private javax.swing.JComboBox cbbDvt;
    private javax.swing.JComboBox cbbGiaLe;
    private javax.swing.JComboBox cbbNhaCungCap;
    private javax.swing.JComboBox cbbTrongLuong;
    private javax.swing.JFileChooser chon;
    private javax.swing.JScrollPane clpBangSP1;
    private javax.swing.JScrollPane clpBangSP2;
    private javax.swing.JScrollPane clpBangSP3;
    private javax.swing.JButton jButton1;
    private javax.swing.JButton jButton2;
    private javax.swing.JButton jButton3;
    private javax.swing.JButton jButton4;
    private javax.swing.JButton jButton5;
    private javax.swing.JButton jButton6;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel10;
    private javax.swing.JLabel jLabel11;
    private javax.swing.JLabel jLabel12;
    private javax.swing.JLabel jLabel13;
    private javax.swing.JLabel jLabel14;
    private javax.swing.JLabel jLabel15;
    private javax.swing.JLabel jLabel16;
    private javax.swing.JLabel jLabel18;
    private javax.swing.JLabel jLabel19;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel20;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JLabel jLabel9;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel10;
    private javax.swing.JPanel jPanel11;
    private javax.swing.JPanel jPanel12;
    private javax.swing.JPanel jPanel13;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JPanel jPanel4;
    private javax.swing.JPanel jPanel5;
    private javax.swing.JPanel jPanel6;
    private javax.swing.JPanel jPanel7;
    private javax.swing.JPanel jPanel8;
    private javax.swing.JPanel jPanel9;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JScrollPane jScrollPane3;
    private javax.swing.JSeparator jSeparator1;
    private javax.swing.JSeparator jSeparator2;
    private javax.swing.JSeparator jSeparator3;
    private javax.swing.JTabbedPane jTabbedPane1;
    private javax.swing.JTextArea jTextArea1;
    private javax.swing.JTextArea jTextArea2;
    public static javax.swing.JLabel lblDung;
    public static javax.swing.JLabel lblSS;
    private javax.swing.JPanel pnl1;
    private javax.swing.JPanel pnlDangNhap;
    private javax.swing.JPanel pnlDangNhapDangXuat;
    private javax.swing.JPanel pnlDangXuat;
    public static javax.swing.JTable tblSPExecel;
    public static javax.swing.JTable tblSPExecelLoi;
    public static javax.swing.JTable tblSanPhamChiTiet;
    private javax.swing.JTable tblSanPhamSua;
    private javax.swing.JTabbedPane tbpMainPanel;
    private javax.swing.JFormattedTextField txtDai;
    private javax.swing.JFormattedTextField txtDay;
    private javax.swing.JFormattedTextField txtGia;
    private javax.swing.JFormattedTextField txtGiaLe;
    private javax.swing.JTextField txtKhac;
    private javax.swing.JPasswordField txtPass;
    private javax.swing.JTextField txtQuyCach;
    private javax.swing.JTextField txtTenSP;
    private javax.swing.JTextField txtTimKiem;
    private javax.swing.JFormattedTextField txtTrongLuong;
    // End of variables declaration//GEN-END:variables
}
